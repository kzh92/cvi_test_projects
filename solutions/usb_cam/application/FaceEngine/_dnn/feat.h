
#ifndef _Feature_H__INCLUDED_
#define _Feature_H__INCLUDED_

#include "ennq_global.h"

using namespace ENNQ;
class Feature
{
private:
	signed char* conv1; // [1728]
	float* conv1_sc; // [64]
	float* conv1_bs; // [64]
	float* conv1_prelu; // [64]
	signed char* conv1_dw; // [576]
	float* conv1_dw_sc; // [64]
	float* conv1_dw_bs; // [64]
	float* conv1_dw_prelu; // [64]
	signed char* conv2_ex; // [8192]
	float* conv2_ex_sc; // [128]
	float* conv2_ex_bs; // [128]
	float* conv2_ex_prelu; // [128]
	signed char* conv2_dw; // [1152]
	float* conv2_dw_sc; // [128]
	float* conv2_dw_bs; // [128]
	float* conv2_dw_prelu; // [128]
	signed char* conv2_em; // [8192]
	float* conv2_em_sc; // [64]
	float* conv2_em_bs; // [64]
	signed char* conv2_1_ex; // [8192]
	float* conv2_1_ex_sc; // [128]
	float* conv2_1_ex_bs; // [128]
	float* conv2_1_ex_prelu; // [128]
	signed char* conv2_1_dw; // [1152]
	float* conv2_1_dw_sc; // [128]
	float* conv2_1_dw_bs; // [128]
	float* conv2_1_dw_prelu; // [128]
	signed char* conv2_1_em; // [8192]
	float* conv2_1_em_sc; // [64]
	float* conv2_1_em_bs; // [64]
	signed char* conv2_2_ex; // [8192]
	float* conv2_2_ex_sc; // [128]
	float* conv2_2_ex_bs; // [128]
	float* conv2_2_ex_prelu; // [128]
	signed char* conv2_2_dw; // [1152]
	float* conv2_2_dw_sc; // [128]
	float* conv2_2_dw_bs; // [128]
	float* conv2_2_dw_prelu; // [128]
	signed char* conv2_2_em; // [8192]
	float* conv2_2_em_sc; // [64]
	float* conv2_2_em_bs; // [64]
	signed char* conv2_3_ex; // [8192]
	float* conv2_3_ex_sc; // [128]
	float* conv2_3_ex_bs; // [128]
	float* conv2_3_ex_prelu; // [128]
	signed char* conv2_3_dw; // [1152]
	float* conv2_3_dw_sc; // [128]
	float* conv2_3_dw_bs; // [128]
	float* conv2_3_dw_prelu; // [128]
	signed char* conv2_3_em; // [8192]
	float* conv2_3_em_sc; // [64]
	float* conv2_3_em_bs; // [64]
	signed char* conv2_4_ex; // [8192]
	float* conv2_4_ex_sc; // [128]
	float* conv2_4_ex_bs; // [128]
	float* conv2_4_ex_prelu; // [128]
	signed char* conv2_4_dw; // [1152]
	float* conv2_4_dw_sc; // [128]
	float* conv2_4_dw_bs; // [128]
	float* conv2_4_dw_prelu; // [128]
	signed char* conv2_4_em; // [8192]
	float* conv2_4_em_sc; // [64]
	float* conv2_4_em_bs; // [64]
	signed char* conv3_ex; // [16384]
	float* conv3_ex_sc; // [256]
	float* conv3_ex_bs; // [256]
	float* conv3_ex_prelu; // [256]
	signed char* conv3_dw; // [2304]
	float* conv3_dw_sc; // [256]
	float* conv3_dw_bs; // [256]
	float* conv3_dw_prelu; // [256]
	signed char* conv3_em; // [32768]
	float* conv3_em_sc; // [128]
	float* conv3_em_bs; // [128]
	signed char* conv3_1_ex; // [32768]
	float* conv3_1_ex_sc; // [256]
	float* conv3_1_ex_bs; // [256]
	float* conv3_1_ex_prelu; // [256]
	signed char* conv3_1_dw; // [2304]
	float* conv3_1_dw_sc; // [256]
	float* conv3_1_dw_bs; // [256]
	float* conv3_1_dw_prelu; // [256]
	signed char* conv3_1_em; // [32768]
	float* conv3_1_em_sc; // [128]
	float* conv3_1_em_bs; // [128]
	signed char* conv3_2_ex; // [32768]
	float* conv3_2_ex_sc; // [256]
	float* conv3_2_ex_bs; // [256]
	float* conv3_2_ex_prelu; // [256]
	signed char* conv3_2_dw; // [2304]
	float* conv3_2_dw_sc; // [256]
	float* conv3_2_dw_bs; // [256]
	float* conv3_2_dw_prelu; // [256]
	signed char* conv3_2_em; // [32768]
	float* conv3_2_em_sc; // [128]
	float* conv3_2_em_bs; // [128]
	signed char* conv3_3_ex; // [32768]
	float* conv3_3_ex_sc; // [256]
	float* conv3_3_ex_bs; // [256]
	float* conv3_3_ex_prelu; // [256]
	signed char* conv3_3_dw; // [2304]
	float* conv3_3_dw_sc; // [256]
	float* conv3_3_dw_bs; // [256]
	float* conv3_3_dw_prelu; // [256]
	signed char* conv3_3_em; // [32768]
	float* conv3_3_em_sc; // [128]
	float* conv3_3_em_bs; // [128]
	signed char* conv3_4_ex; // [32768]
	float* conv3_4_ex_sc; // [256]
	float* conv3_4_ex_bs; // [256]
	float* conv3_4_ex_prelu; // [256]
	signed char* conv3_4_dw; // [2304]
	float* conv3_4_dw_sc; // [256]
	float* conv3_4_dw_bs; // [256]
	float* conv3_4_dw_prelu; // [256]
	signed char* conv3_4_em; // [32768]
	float* conv3_4_em_sc; // [128]
	float* conv3_4_em_bs; // [128]
	signed char* conv3_5_ex; // [32768]
	float* conv3_5_ex_sc; // [256]
	float* conv3_5_ex_bs; // [256]
	float* conv3_5_ex_prelu; // [256]
	signed char* conv3_5_dw; // [2304]
	float* conv3_5_dw_sc; // [256]
	float* conv3_5_dw_bs; // [256]
	float* conv3_5_dw_prelu; // [256]
	signed char* conv3_5_em; // [32768]
	float* conv3_5_em_sc; // [128]
	float* conv3_5_em_bs; // [128]
	signed char* conv3_6_ex; // [32768]
	float* conv3_6_ex_sc; // [256]
	float* conv3_6_ex_bs; // [256]
	float* conv3_6_ex_prelu; // [256]
	signed char* conv3_6_dw; // [2304]
	float* conv3_6_dw_sc; // [256]
	float* conv3_6_dw_bs; // [256]
	float* conv3_6_dw_prelu; // [256]
	signed char* conv3_6_em; // [32768]
	float* conv3_6_em_sc; // [128]
	float* conv3_6_em_bs; // [128]
	signed char* conv4_ex; // [65536]
	float* conv4_ex_sc; // [512]
	float* conv4_ex_bs; // [512]
	float* conv4_ex_prelu; // [512]
	signed char* conv4_dw; // [4608]
	float* conv4_dw_sc; // [512]
	float* conv4_dw_bs; // [512]
	float* conv4_dw_prelu; // [512]
	signed char* conv4_em; // [65536]
	float* conv4_em_sc; // [128]
	float* conv4_em_bs; // [128]
	signed char* conv4_1_ex; // [32768]
	float* conv4_1_ex_sc; // [256]
	float* conv4_1_ex_bs; // [256]
	float* conv4_1_ex_prelu; // [256]
	signed char* conv4_1_dw; // [2304]
	float* conv4_1_dw_sc; // [256]
	float* conv4_1_dw_bs; // [256]
	float* conv4_1_dw_prelu; // [256]
	signed char* conv4_1_em; // [32768]
	float* conv4_1_em_sc; // [128]
	float* conv4_1_em_bs; // [128]
	signed char* conv4_2_ex; // [32768]
	float* conv4_2_ex_sc; // [256]
	float* conv4_2_ex_bs; // [256]
	float* conv4_2_ex_prelu; // [256]
	signed char* conv4_2_dw; // [2304]
	float* conv4_2_dw_sc; // [256]
	float* conv4_2_dw_bs; // [256]
	float* conv4_2_dw_prelu; // [256]
	signed char* conv4_2_em; // [32768]
	float* conv4_2_em_sc; // [128]
	float* conv4_2_em_bs; // [128]
	signed char* conv5_ex; // [65536]
	float* conv5_ex_sc; // [512]
	float* conv5_ex_bs; // [512]
	float* conv5_ex_prelu; // [512]
	signed char* conv5_dw; // [32768]
	float* conv5_dw_sc; // [512]
	float* conv5_dw_bs; // [512]
	float* fc1_512_table; // [256]
	unsigned char* fc1_512_index; // [262144]
	float* fc1_512_sc; // [512]
	float* fc1_512_bs; // [512]
	float* conv2_1_ex_q; // [1]
	float* conv2_2_ex_q; // [1]
	float* conv2_3_ex_q; // [1]
	float* conv2_4_ex_q; // [1]
	float* conv3_ex_q; // [1]
	float* conv3_1_ex_q; // [1]
	float* conv3_2_ex_q; // [1]
	float* conv3_3_ex_q; // [1]
	float* conv3_4_ex_q; // [1]
	float* conv3_5_ex_q; // [1]
	float* conv3_6_ex_q; // [1]
	float* conv4_ex_q; // [1]
	float* conv4_1_ex_q; // [1]
	float* conv4_2_ex_q; // [1]
	float* conv5_ex_q; // [1]
	float* fc1_512;

	unsigned char* dic_data;
	unsigned char* mem_data;

	ennq_blob* mem_blk0;
	ennq_blob* mem_blk1;
	ennq_blob* mem_blk2;
	ennq_blob* mem_blk3;

	int g_nEngineLoaded;

public:
    Feature();
    ~Feature();

	static int dnn_dic_size();
	static int dnn_mem_size();
	int dnn_create(const char* fn, float rConfig = 75.0f, unsigned char* pMemBuf = 0);
	int dnn_create(unsigned char* pDicData, int nDicDataSize, float rConfig = 75.0f, unsigned char* pMemBuf = 0);
	void dnn_free();
	float* dnn_forward(unsigned char* in, int fIsColor = 0);
	int getEngineLoaded();
};

#endif //_Feature_H__INCLUDED_
